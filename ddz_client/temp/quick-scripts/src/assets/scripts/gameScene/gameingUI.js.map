{"version":3,"sources":["assets/scripts/gameScene/gameingUI.js"],"names":["cc","Class","Component","properties","gameingUI","Node","card_prefab","Prefab","robUI","bottom_card_pos_node","playingUI_node","tipsLabel","Label","onLoad","cards_nods","card_width","rob_player_accountid","fapai_end","bottom_card","bottom_card_data","choose_card_data","outcar_zone","push_card_tmp","myglobal","socket","onPushCards","data","console","log","JSON","stringify","card_data","cur_index_card","length","pushCard","isopen_sound","fapai_audioID","scheduleOnce","_runactive_pushcard","bind","node","parent","emit","onCanRobState","playerData","accountID","active","onCanChuCard","clearOutZone","onOtherPlayerChuCard","accountid","gameScene_script","getComponent","outCard_node","getUserOutCardPosByAccount","node_cards","i","cards","card","instantiate","showCards","push","appendOtherCardsToOutZone","on","show_data","call_data","run","callFunc","target","activedata","show_card","obj","runAction","sequence","rotateBy","scaleBy","audioEngine","play","url","raw","master_accountid","pushThreeCard","event","detail","cardid","splice","start","stop","sendevent","move_node","newx","x","action","moveTo","v2","sortCard","sort","y","a","b","hasOwnProperty","value","king","timeout","setTimeout","zIndex","width","scale","di_card","position","schedulePushThreeCard","last_card_x","destoryCard","choose_card","destroy_card","j","card_id","removeFromParent","appendCardsToOutZone","updateCards","children","destroy","removeAllChildren","pushCardSort","yoffset","addChild","zPoint","cardNode","getChildren","setScale","setPosition","zeroPoint","playPushCardSound","card_name","CardsValue","one","name","onButtonClick","customData","requestRobState","qian_state","qian","buqiang","request_buchu_card","string","request_chu_card","err","msg","cardvalue","account"],"mappings":"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","sourceRoot":"/","sourcesContent":["import myglobal from \"../../mygolbal.js\"\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gameingUI: cc.Node,\n        card_prefab:cc.Prefab,\n        robUI:cc.Node,\n        bottom_card_pos_node:cc.Node,\n        playingUI_node:cc.Node,\n        tipsLabel:cc.Label, //玩家出牌不合法的tips\n    \n    },\n\n    onLoad () {\n        //自己牌列表 \n        this.cards_nods = []\n        this.card_width = 0\n        //当前可以抢地主的accountid\n        this.rob_player_accountid = 0\n        //发牌动画是否结束\n        this.fapai_end = false\n        //底牌数组\n        this.bottom_card = []\n        //底牌的json对象数据\n        this.bottom_card_data=[]\n        this.choose_card_data=[]\n        this.outcar_zone = []\n\n        this.push_card_tmp = []\n        //监听服务器:下发牌消息\n        myglobal.socket.onPushCards(function(data){\n            console.log(\"onPushCards\"+JSON.stringify(data))\n            this.card_data = data\n            this.cur_index_card = data.length - 1\n            this.pushCard(data)\n            if(isopen_sound){\n                //循环播放发牌音效\n               // this.fapai_audioID = cc.audioEngine.play(cc.url.raw(\"resources/sound/fapai1.mp3\"),true)\n                console.log(\"start fapai_audioID\"+this.fapai_audioID) \n            }\n             //左边移动定时器\n            this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\n            this.node.parent.emit(\"pushcard_other_event\")\n           \n        }.bind(this))\n\n        //监听服务器:通知抢地主消息,显示相应的UI\n        myglobal.socket.onCanRobState(function(data){\n            console.log(\"onCanRobState\"+JSON.stringify(data))\n            //这里需要2个变量条件：自己是下一个抢地主，2发牌动画结束\n            this.rob_player_accountid = data\n            if(data==myglobal.playerData.accountID && this.fapai_end==true){\n                this.robUI.active = true\n            }\n          \n        }.bind(this))\n        \n        //监听服务器可以出牌消息\n        myglobal.socket.onCanChuCard(function(data){\n            console.log(\"onCanRobState\"+JSON.stringify(data))\n            //判断是不是自己能出牌\n            if(data==myglobal.playerData.accountID){\n                //先清理出牌区域\n                this.clearOutZone(myglobal.playerData.accountID)\n                //先把自己出牌列表置空\n                //this.choose_card_data=[]\n                //显示可以出牌的UI\n                this.playingUI_node.active = true\n\n            }\n        }.bind(this))\n\n        //监听服务器：其他玩家出牌消息\n        myglobal.socket.onOtherPlayerChuCard(function(data){\n            //{\"accountid\":\"2357540\",\"cards\":[{\"cardid\":4,\"card_data\":{\"index\":4,\"value\":1,\"shape\":1}}]}\n            console.log(\"onOtherPlayerChuCard\"+JSON.stringify(data))\n\n            var accountid = data.accountid\n            var gameScene_script = this.node.parent.getComponent(\"gameScene\")\n            //获取出牌区域节点\n            var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\n            if(outCard_node==null){\n                return\n            }\n\n            var node_cards = []\n            for(var i=0;i<data.cards.length;i++){\n                var card = cc.instantiate(this.card_prefab)\n                card.getComponent(\"card\").showCards(data.cards[i].card_data,myglobal.playerData.accountID)\n                node_cards.push(card)\n            }\n            this.appendOtherCardsToOutZone(outCard_node,node_cards,0)\n\n            \n        }.bind(this))\n\n        //内部事件:显示底牌事件,data是三张底牌数据\n        this.node.on(\"show_bottom_card_event\",function(data){\n            console.log(\"----show_bottom_card_event\",+data)\n          \n            this.bottom_card_data = data\n            \n            for(var i=0;i<data.length;i++){\n                var card = this.bottom_card[i]\n                var show_data = data[i]\n                var call_data = {\n                    \"obj\":card,\n                    \"data\":show_data,\n                }\n                console.log(\"bottom show_data:\"+JSON.stringify(show_data))\n                var run =  cc.callFunc(function(target,activedata){\n                   \n                    var show_card = activedata.obj\n                    var show_data = activedata.data\n                    //console.log(\"cc.callFunc:\"+JSON.stringify(show_data))\n                    show_card.getComponent(\"card\").showCards(show_data)\n                   \n                },this,call_data)\n\n                card.runAction(cc.sequence(cc.rotateBy(0,0,180),cc.rotateBy(0.2,0,-90), run,\n                cc.rotateBy(0.2,0,-90),cc.scaleBy(1, 1.2)));\n               \n                if(isopen_sound){\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/start.mp3\")) \n                 }\n            }\n\n            //this.node.parent.emit(\"change_room_state_event\",RoomState.ROOM_PLAYING)\n            //如果自己地主，给加上三张底牌\n            if(myglobal.playerData.accountID==myglobal.playerData.master_accountid){\n                this.scheduleOnce(this.pushThreeCard.bind(this),0.2)\n            }\n            \n              \n        }.bind(this))\n\n        //注册监听一个选择牌消息 \n        this.node.on(\"choose_card_event\",function(event){\n            console.log(\"choose_card_event:\"+JSON.stringify(event))\n            var detail = event\n            this.choose_card_data.push(detail)\n        }.bind(this))\n\n        this.node.on(\"unchoose_card_event\",function(event){\n            console.log(\"unchoose_card_event:\"+ event)\n            var detail = event\n            for(var i=0;i<this.choose_card_data.length;i++){\n                if(this.choose_card_data[i].cardid==detail){\n                    this.choose_card_data.splice(i,1)\n                }\n            }\n        }.bind(this))\n\n    },\n\n    start () {\n     \n    },\n\n    //处理发牌的效果\n    _runactive_pushcard(){\n        //console.log(\"_runactive_pushcard:\"+this.cur_index_card)\n        if(this.cur_index_card < 0){\n            console.log(\"pushcard end\")\n            //发牌动画完成，显示抢地主按钮\n            //this.robUI.active = true\n            this.fapai_end = true\n            if(this.rob_player_accountid==myglobal.playerData.accountID){\n                this.robUI.active = true\n            }\n\n            if(isopen_sound){\n                //console.log(\"start fapai_audioID\"+this.fapai_audioID) \n                cc.audioEngine.stop(this.fapai_audioID)\n            }\n           \n\n              //通知gamescene节点，倒计时\n            var sendevent = this.rob_player_accountid\n            this.node.parent.emit(\"canrob_event\",sendevent)\n\n            return\n        }\n\n        //原有逻辑  \n        // var move_node = this.cards_nods[this.cur_index_card]\n        // move_node.active = true\n        // var newx = move_node.x + (this.card_width * 0.4*this.cur_index_card) - (this.card_width * 0.4)\n        // var action = cc.moveTo(0.1, cc.v2(newx, -250));\n        // move_node.runAction(action)\n        // this.cur_index_card--\n        // this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\n\n        \n        var move_node = this.cards_nods[this.cards_nods.length-this.cur_index_card-1]\n        move_node.active = true\n        this.push_card_tmp.push(move_node)\n        this.fapai_audioID = cc.audioEngine.play(cc.url.raw(\"resources/sound/fapai1.mp3\"))\n        for(var i=0;i<this.push_card_tmp.length-1;i++){\n                var move_node = this.push_card_tmp[i]\n                var newx = move_node.x - (this.card_width * 0.4)\n                var action = cc.moveTo(0.1, cc.v2(newx, -250));\n                move_node.runAction(action)\n        }\n        \n        this.cur_index_card--\n        this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\n    },\n \n    //对牌排序\n    sortCard(){\n        this.cards_nods.sort(function(x,y){\n            var a = x.getComponent(\"card\").card_data;\n            var b = y.getComponent(\"card\").card_data;\n\n            if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\n                return  b.value-a.value;\n            }\n            if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\n                return -1;\n            }\n            if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                return 1;\n            }\n            if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                return  b.king-a.king;\n            }\n        })\n        //var x = this.cards_nods[0].x;\n        //这里使用固定坐标，因为取this.cards_nods[0].xk可能排序为完成，导致x错误\n        //所以做1000毫秒的延时\n        var timeout = 1000\n        setTimeout(function(){\n            //var x = -417.6 \n            var x = this.cards_nods[0].x;\n            console.log(\"sort x:\"+ x)\n            for (let i = 0; i < this.cards_nods.length; i++) {\n                var card = this.cards_nods[i];\n                card.zIndex = i; //设置牌的叠加次序,zindex越大显示在上面\n                card.x = x + card.width * 0.4 * i;\n            }\n        }.bind(this), timeout);\n        \n       \n    },\n\n  \n    pushCard(data){\n    if (data) {\n            data.sort(function (a, b) {\n                if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\n                    return b.value - a.value;\n                }\n                if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\n                    return -1;\n                }\n                if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                    return 1;\n                }\n                if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                    return b.king - a.king;\n                }\n            });\n        }\n      //创建card预制体\n      this.cards_nods = []\n      for(var i=0;i<17;i++){\n        \n        var card = cc.instantiate(this.card_prefab)\n        card.scale=0.8\n        card.parent = this.node.parent\n        //card.x = card.width * 0.4 * (17 - 1) * (-0.5) + card.width * 0.4 * 0;\n        card.x = card.width * 0.4 * (-0.5) * (-16) + card.width * 0.4 * 0;\n        //这里实现为，每发一张牌，放在已经发的牌最后，然后整体移动\n        card.y = -250\n        card.active = false\n\n        card.getComponent(\"card\").showCards(data[i],myglobal.playerData.accountID)\n        //存储牌的信息,用于后面发牌效果\n        this.cards_nods.push(card)\n        this.card_width = card.width\n      }\n      \n      //创建3张底牌\n      this.bottom_card = []\n      for(var i=0;i<3;i++){\n        var di_card = cc.instantiate(this.card_prefab)\n        di_card.scale=0.4\n        di_card.position = this.bottom_card_pos_node.position \n        //三张牌，中间坐标就是bottom_card_pos_node节点坐标，\n        //0,和2两张牌左右移动windth*0.4\n        if(i==0){\n            \n            di_card.x = di_card.x - di_card.width*0.4\n        }else if(i==2){\n            di_card.x = di_card.x + di_card.width*0.4\n        }\n        \n\n        //di_card.x = di_card.width-i*di_card.width-20\n        //di_card.y=60\n        di_card.parent = this.node.parent\n        //存储在容器里\n        this.bottom_card.push(di_card)\n      }\n\n    },\n\n    //给玩家发送三张底牌后，过1s,把牌设置到y=-250位置效果\n    schedulePushThreeCard(){\n        for(var i=0;i<this.cards_nods.length;i++){\n            var card = this.cards_nods[i]\n            if(card.y==-230){\n                card.y = -250\n            }\n        }\n    },\n    //给地主发三张排，并显示在原有牌的后面\n    pushThreeCard(){\n        //每张牌的其实位置 \n        var last_card_x =  this.cards_nods[this.cards_nods.length-1].x\n        for(var i=0;i<this.bottom_card_data.length;i++){\n            var card = cc.instantiate(this.card_prefab)\n            card.scale=0.8\n            card.parent = this.node.parent\n          \n            card.x = last_card_x + ((i+1)*this.card_width * 0.4)\n            card.y = -230  //先把底盘放在-230，在设置个定时器下移到-250的位置\n           \n            //console.log(\"pushThreeCard x:\"+card.x)\n            card.getComponent(\"card\").showCards(this.bottom_card_data[i],myglobal.playerData.accountID)\n            card.active = true\n            this.cards_nods.push(card)\n        }\n\n        this.sortCard()\n        //设置一个定时器，在2s后，修改y坐标为-250\n        this.scheduleOnce(this.schedulePushThreeCard.bind(this),2)\n\n    },\n\n    destoryCard(accountid,choose_card){\n        if(choose_card.length==0){\n            return\n        }\n\n        /*出牌逻辑\n          1. 将选中的牌 从父节点中移除\n          2. 从this.cards_nods 数组中，删除 选中的牌 \n          3. 将 “选中的牌” 添加到出牌区域\n              3.1 清空出牌区域\n              3.2 添加子节点\n              3.3 设置scale\n              3.4 设置position\n          4.  重新设置手中的牌的位置  this.updateCards();\n        */\n        //1/2步骤删除自己手上的card节点 \n        var destroy_card = []\n        for(var i=0;i<choose_card.length;i++){\n            for(var j=0;j<this.cards_nods.length;j++){\n                var card_id = this.cards_nods[j].getComponent(\"card\").card_id\n                if(card_id==choose_card[i].cardid){\n                    console.log(\"destroy card id:\"+card_id)\n                    //this.cards_nods[j].destroy()\n                    this.cards_nods[j].removeFromParent(true);\n                    destroy_card.push(this.cards_nods[j])\n                    this.cards_nods.splice(j,1)\n                }\n            }\n        }\n\n        this.appendCardsToOutZone(accountid,destroy_card)\n        this.updateCards()\n\n    },\n\n    //清除显示出牌节点全部子节点(就是把出牌的清空)\n    clearOutZone(accountid){\n        var gameScene_script = this.node.parent.getComponent(\"gameScene\")\n        var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\n        var children = outCard_node.children;\n        for(var i=0;i<children.length;i++){\n            var card = children[i]; \n            card.destroy()\n        }\n        outCard_node.removeAllChildren(true);\n    },\n    //对出的牌做排序\n    pushCardSort(cards){\n        if(cards.length==1){\n            return\n        }\n        cards.sort(function(x,y){\n            var a = x.getComponent(\"card\").card_data;\n            var b = y.getComponent(\"card\").card_data;\n\n            if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\n                return b.value - a.value;\n            }\n            if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\n                return -1;\n            }\n            if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                return 1;\n            }\n            if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                return b.king - a.king;\n            }\n        })\n    },\n\n    appendOtherCardsToOutZone(outCard_node,cards,yoffset){\n       outCard_node.removeAllChildren(true);\n\n       //console.log(\"appendOtherCardsToOutZone length\"+cards.length)\n       //添加新的子节点\n       for(var i=0;i<cards.length;i++){\n           var card = cards[i]; \n           outCard_node.addChild(card,100+i) //第二个参数是zorder,保证牌不能被遮住\n       }\n\n       //对出牌进行排序\n       //设置出牌节点的坐标\n       var zPoint = cards.length / 2;\n       //console.log(\"appendOtherCardsToOutZone zeroPoint:\"+zPoint)\n       for(var i=0;i<cards.length;i++){\n        var cardNode = outCard_node.getChildren()[i]\n        var x = (i - zPoint) * 30;\n        var y = cardNode.y+yoffset; //因为每个节点需要的Y不一样，做参数传入\n        //console.log(\"-----cardNode: x:\"+x+\" y:\"+y)\n        cardNode.setScale(0.5, 0.5);                   \n        cardNode.setPosition(x,y);                     \n\n       }\n    },\n    //将 “选中的牌” 添加到出牌区域\n    //destroy_card是玩家本次出的牌\n    appendCardsToOutZone(accountid,destroy_card){\n        if(destroy_card.length==0){\n            return\n        }\n        //先给本次出的牌做一个排序\n       this.pushCardSort(destroy_card)\n       //console.log(\"appendCardsToOutZone\")\n       var gameScene_script = this.node.parent.getComponent(\"gameScene\")\n       //获取出牌区域节点\n       var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\n       this.appendOtherCardsToOutZone(outCard_node,destroy_card,360)\n       //sconsole.log(\"OutZone:\"+outCard_node.name)\n\n    },\n\n    //重新排序手上的牌,并移动\n    updateCards(){\n    \n        var zeroPoint = this.cards_nods.length / 2;\n        //var last_card_x = this.cards_nods[this.cards_nods.length-1].x\n        for(var i=0;i<this.cards_nods.length;i++){\n            var cardNode = this.cards_nods[i]\n            var x = (i - zeroPoint)*(this.card_width * 0.4);\n            cardNode.setPosition(x, -250);  \n        }\n\n    },\n    \n    playPushCardSound(card_name){\n        console.log(\"playPushCardSound:\"+card_name)\n        \n        if(card_name==\"\"){\n            return\n        }\n\n        switch(card_name){\n            case CardsValue.one.name:\n                break\n            case CardsValue.double.name:\n                    if(isopen_sound){\n                        cc.audioEngine.play(cc.url.raw(\"resources/sound/duizi.mp3\")) \n                     }\n                break  \n        }\n    },\n    // update (dt) {},\n    onButtonClick(event,customData){\n        switch(customData){\n            case \"btn_qiandz\":\n                console.log(\"btn_qiandz\")\n                myglobal.socket.requestRobState(qian_state.qian)\n                this.robUI.active = false\n                if(isopen_sound){\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_jiao_di_zhu.ogg\")) \n                 }\n                break\n            case \"btn_buqiandz\":\n                console.log(\"btn_buqiandz\")\n                myglobal.socket.requestRobState(qian_state.buqiang)\n                this.robUI.active = false\n                if(isopen_sound){\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_bu_jiao.ogg\")) \n                 }\n                 break    \n             case \"nopushcard\":  //不出牌\n                 myglobal.socket.request_buchu_card([],null)\n                 this.playingUI_node.active = false\n                 break\n             case \"pushcard\":   //出牌\n                 //先获取本次出牌数据\n                 if(this.choose_card_data.length==0){\n                    this.tipsLabel.string=\"请选择牌!\"\n                    setTimeout(function(){\n                        this.tipsLabel.string=\"\"\n                    }.bind(this), 2000);\n                 }\n                 myglobal.socket.request_chu_card(this.choose_card_data,function(err,data){\n                   \n                    if(err){\n                        console.log(\"request_chu_card:\"+err)\n                        console.log(\"request_chu_card\"+JSON.stringify(data))\n                        if(this.tipsLabel.string==\"\"){\n                            this.tipsLabel.string = data.msg\n                            setTimeout(function(){\n                                this.tipsLabel.string=\"\"\n                            }.bind(this), 2000);\n                        }\n                        \n                        //出牌失败，把选择的牌归位\n                        for(var i=0;i<this.cards_nods.length;i++){\n                            var card = this.cards_nods[i]\n                            card.emit(\"reset_card_flag\")\n                        }\n                        this.choose_card_data = []\n                     }else{\n                         //出牌成功\n                         console.log(\"resp_chu_card data:\"+JSON.stringify(data))\n                         this.playingUI_node.active = false\n                         //播放出牌的声音\n                         //resp_chu_card data:{\"account\":\"2519901\",\"msg\":\"sucess\",\"cardvalue\":{\"name\":\"Double\",\"value\":1}}\n                         //{\"type\":\"other_chucard_notify\",\"result\":0,\"data\":{\"accountid\":\"2519901\",\"cards\":[{\"cardid\":24,\"card_data\":{\"index\":24,\"value\":6,\"shape\":1}},{\"cardid\":26,\"card_data\":{\"index\":26,\"value\":6,\"shape\":3}}]},\"callBackIndex\":0}\n                         this.playPushCardSound(data.cardvalue.name)\n                         this.destoryCard(data.account,this.choose_card_data)\n                         this.choose_card_data = []\n                     \n                     }\n                    \n                 }.bind(this))\n                 //this.playingUI_node.active = false\n                 break\n             case \"tipcard\":\n                 break            \n            default:\n                break\n        }\n    }\n\n\n});\n"]}